<!--
Copyright (c) 2018 Michael Neill Hartman. All rights reserved.
mnh_license@proton.me
https://github.com/hartmanm
-->
<!DOCTYPE html>
<html lang="en">
<head>
<title>display engine 1</title>
<meta charset="utf-8"> 
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="Description" content="engine1">
<link rel="stylesheet" href="bootstrap_3_3_7.css">
<style>
.grid_container{
max-width: 100vw;
max-height: 1000vh;
margin: auto;
}
.csv_interface{ 
max-width: 10vw;
max-height: 10vh;
margin:7vw,1vw,1vw;
border:2vw; 
border-color:rgba(33, 7, 51, 0.822);
background:rgba(70, 135, 196, 0.623);
color: white;
}
.out_interface{ 
max-width: 95vw;
max-height: 5vh;
margin:7vw,1vw,1vw;
border:2vw; 
border-color:rgba(33, 7, 51, 0.822);
/* background:rgba(141, 168, 218, 0.623); */
color: white;
}
body{margin: 2vw; background:rgba(111, 125, 121, 0.66);}
</style>
</head>
<body>
<div id="csv_interface" class="csv_interface">
<p>Choose a CSV File:</p>
<input id="csv" type="file">
</div> <!-- <div id="csv_interface"> -->

<div id="json_interface" class="csv_interface">
<p>Choose a JSON File:</p>
<input id="json" type="file">
</div> <!-- <div id="json_interface"> -->

<output id="file_reader_out" class="out_interface"></output>
<div id="base" class="grid_container"></div>
<script>
'use strict';
var base = document.getElementById("base");
var inner_html = {}
var image_selector=[]
//
function execute_z(){
var temp = inner_html;
var base = document.getElementById("base");
base.innerHTML="";
inner_html={}
inner_html=temp;
} //  function execute_z()
//
var fileInput = document.getElementById("csv"),
readFile = function () {
var reader = new FileReader();
reader.onload = function () {
document.getElementById('file_reader_out').innerHTML = reader.result;
var temp = document.getElementById('file_reader_out').innerHTML
var temp = temp.split(',');
image_selector=[]
inner_html = {}
execute_z();
for(var key of temp){if(key != ""){image_selector.push(key);console.log(key);}};
console.log(base.innerHTML);
reload();
};
reader.readAsBinaryString(fileInput.files[0]);
};
fileInput.addEventListener('change', readFile);
//
var fileInput_json = document.getElementById("json"),
readFile2 = function () {
var reader = new FileReader();
reader.onload = function () {
document.getElementById('file_reader_out').innerHTML = reader.result;
var temp = document.getElementById('file_reader_out').innerHTML
var map = temp;
execute_z();
image_selector=[]
inner_html = {}
console.log(map);
var jsonobj = JSON.parse(map);

for(var key in jsonobj){if(key != ""){image_selector.push(jsonobj[key]);console.log(jsonobj[key]);}};

//var temp = temp.split(',');





//for(var key of temp){if(key != ""){image_selector.push(key);console.log(key);}};
//console.log(base.innerHTML);
reload();
};
reader.readAsBinaryString(fileInput_json.files[0]);
};
fileInput_json.addEventListener('change', readFile2);
//
function reload(){
var lambda_background_color="#7F9AB7"; //brown #B79C7F //grey #7F9AB7
//var screen_width=screen.width;
//var screen_height=screen.height;
var screen_width = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);

//var screen_width = window.availWidth;
var screen_height = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
//var grid_wide=Math.floor(parseInt((screen_width/22)));
var resolution=screen_width*screen_height
console.log("resolution: " + resolution);
var w=22
var h=22
var grid_wide=Math.floor(parseInt((screen_width/w)));
var grid_long=Math.floor(parseInt((screen_height/h)));
var current_area=grid_wide*w*grid_long*h
console.log("current_area: " + current_area);

while(current_area > resolution)
{
w=w-1
h=h-1
grid_wide=Math.floor(parseInt((screen_width/w)));
grid_long=Math.floor(parseInt((screen_height/h)));
current_area=grid_wide*w*grid_long*h
console.log("resolution: " + resolution);
console.log("current_area: " + current_area);
console.log("w: " + w);
console.log("h: " + h);
console.log("grid_wide: " + grid_wide);
console.log("grid_long: " + grid_long);
}
//var end =20000
var end =500000
var enter = 0
//while((current_area < (resolution-29000)) && (enter < end))
//while((current_area < (resolution-70000)) && (enter < end))
while((current_area < (resolution-500000)) && (enter < end))
//while((current_area < (resolution-grid_wide*w*10)) && (enter < end))
{
grid_wide=grid_wide+1
grid_long=grid_wide
current_area=grid_wide*w*grid_long*h
//current_area=current_area+grid_long*h*4
console.log("resolution: " + resolution);
console.log("current_area: " + current_area);
console.log("w: " + w);
console.log("h: " + h);
console.log("grid_wide: " + grid_wide);
console.log("grid_long: " + grid_long);
console.log("enter: " + enter);
enter=enter+1
}
var total_grid_squares=Math.floor(w*h);
var additional_grid_squares = grid_wide


/*
while((current_area < (resolution-grid_wide*w*w-1275)) && (enter < end))
{
additional_grid_squares=additional_grid_squares+grid_wide
current_area=grid_wide*w*grid_long*h+additional_grid_squares
//current_area=current_area+grid_long*h*4
console.log("resolution: " + resolution);
console.log("current_area: " + current_area);
console.log("w: " + w);
console.log("h: " + h);
console.log("grid_wide: " + grid_wide);
console.log("grid_long: " + grid_long);
console.log("enter: " + enter);
console.log("additional_grid_squares: " + additional_grid_squares/grid_wide);
enter=enter+1
}
*/

//var max_w screen_width*screen_height=(screen_width/w)*(screen_height/w)
//var max=Math.floor(screen_width/(w*h+3*h));
//console.log("max_w: " + max_w);
//var overflow=Math.floor(w*h-h);
//var grid_wide=Math.floor(parseInt((screen_width/w)));
total_grid_squares=Math.floor(w*h+additional_grid_squares/grid_wide);
//var height_overflow=Math.floor(parseInt((screen_width/total_grid_squares)));
//console.log("height_overflow: " + height_overflow);
////console.log("screen_height: " + screen_height);
/*
while(height_overflow > screen_height)
{
total_grid_squares=total_grid_squares-1
//var grid_wide=Math.floor(parseInt((screen_width/22)));
//w=w-1
//h=h-1
//max=Math.floor(w*h);
//overflow=Math.floor(w*h-h);
height_overflow=Math.floor(parseInt((screen_width/total_grid_squares)));
grid_wide=Math.floor(parseInt((screen_width/w)));
console.log("lambda_size: " + lambda_size);
console.log("screen_width: " + screen_width);
console.log("screen_height: " + screen_height);
console.log("w: " + w);
console.log("h: " + h);
console.log("total_grid_squares: " + total_grid_squares);
var count = Object.keys(inner_html).length;
console.log("number of inner_html keys: " + count);
console.log("height_overflow: " + height_overflow);
console.log("screen_height: " + screen_height);
}
*/
var lambda_size=grid_wide;
lambda_size.toString(10);
lambda_size=lambda_size + "px";
//var grid_high=h;
//var grid_high=10;

function sudo_random_char(length){
var result='';
var characters='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';
var charactersLength=characters.length;
for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength));}
return result;
}
function sudo_random_int(length){
var result='';
var characters='0123456789';
characters = characters.slice(0,image_selector.length);
var charactersLength=characters.length;
for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength));}
return result;
}
for(var i=0;i<total_grid_squares;i++){
var new_img=sudo_random_int(1);
var start_lambda_background_color=lambda_background_color;
var start_lambda_size=lambda_size;
// if sudo random size
//start_lambda_size=sudo_random_int(2);
//start_lambda_size.toString(10);
//start_lambda_size=start_lambda_size + "px";
//console.log("start_lambda_size: " + start_lambda_size);
// if sudo random size
var image_name=image_selector[new_img];
var new_key=sudo_random_char(4);  // any number of duplicate images
//var new_key=image_name;  // no duplicate images
//var inner__html='<img src=' + image_name + '.png style="width:' + start_lambda_size + ';height:' + start_lambda_size + '; background-color: ' + start_lambda_background_color + ';"/>'
var inner__html='<img src=' + image_name + '.jpg style="width:' + start_lambda_size + ';height:' + start_lambda_size + '; background-color: ' + start_lambda_background_color + ';"/>'
//var image=image_selector[new_img];
var image=inner__html;
inner_html[new_key]=image;
}
console.log("lambda_size: " + lambda_size);
console.log("screen_width: " + screen_width);
console.log("screen_height: " + screen_height);
console.log("grid_wide: " + grid_wide);
//console.log("grid_high: " + grid_high);
console.log("total_grid_squares: " + total_grid_squares);
var count = Object.keys(inner_html).length;
console.log("number of inner_html keys: " + count);
//
//lamda_link('base',innerhtml['_8A'],'_8A','_8A');  
function lamda_gen(type){var key;for(key in inner_html){if(type == "init"){lamda_link('base',inner_html[key],key,key);}}}
//
function hover(id){
var out2 = document.getElementById(id);
out2.style = "outline-style: solid; outline-color: #CBD3EE; cursor: pointer;";
}
//
function leave(id){
var out2 = document.getElementById(id);
out2.style = "z-index: 2;transform: scale(1);";
}
//
function lamda_link(basename,innerhtml,id,classname){
var base = document.getElementById(basename);
var ddiv = document.createElement("lamda_link");
ddiv.innerHTML = innerhtml;
ddiv.id = id;
ddiv.className = classname;
base.appendChild(ddiv);
//
function execute_z(id){
var out2 = document.getElementById(id);
console.log("--------------------");
console.log("execute_z: " + id);
var new_lambda_background_color = "#4E2F98"; //#0F6640 green //#660F35 red // #4E2F98 purple
var image_name_inner_html=inner_html[id];
var here = image_name_inner_html.indexOf("src=");
//var there = image_name_inner_html.indexOf(".png");
var there = image_name_inner_html.indexOf(".jpg");
var image_name = image_name_inner_html.slice(here,there);
var here = image_name_inner_html.indexOf("width:");
var there = image_name_inner_html.indexOf(";height");
var new_lambda_size = image_name_inner_html.slice(here,there);
new_lambda_size=parseInt(new_lambda_size.slice(6,-2));
if(new_lambda_size*2 < 400){
new_lambda_size=new_lambda_size*2;
new_lambda_size.toString(10);
new_lambda_size=new_lambda_size + "px";}
else{
new_lambda_size=lambda_size;
new_lambda_size.toString(10);}
//inner_html[id]='<img ' + image_name + '.png style="width:' + new_lambda_size + ';height:' + new_lambda_size + '; background-color: ' + new_lambda_background_color + ';"/>'
inner_html[id]='<img ' + image_name + '.jpg style="width:' + new_lambda_size + ';height:' + new_lambda_size + '; background-color: ' + new_lambda_background_color + ';"/>'
var temp = inner_html;
var base = document.getElementById("base");
base.innerHTML="";
inner_html={}
inner_html=temp;
//
lamda_gen("init");
console.log("new_lambda_size: " + new_lambda_size);
console.log("new_lambda_background_color: " + new_lambda_background_color);
} //  function execute_z(id)
//
var lamdalink = document.getElementById(id);
lamdalink.addEventListener("mouseover", function(e){var target = e.target || e.srcElement; hover(id)}, false);
lamdalink.addEventListener("mouseleave", function(e){var target = e.target || e.srcElement; leave(id)}, false);
lamdalink.addEventListener("click", function(e){var target = e.target || e.srcElement; execute_z(id)}, false);
}
//
lamda_gen("init");
}
//
</script>
</body>
</html>